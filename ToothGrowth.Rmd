---
title: "Tooth Growth dataset analysis"
subtitle: "Course Project for Statistical Inference Coursera Class"
author: "Leon Duplay"
date: "16 July 2015"
output: 
  html_document: 
    fig_height: 3
    fig_width: 10
    keep_md: yes
    theme: readable
---

## Overview

In this document, we will investigate the ToothGrowth dataset by performing some basic exploratory data analysis and some statistical inference. By using confidence intervals and/or hypothesis tests to compare tooth growth by `supp` and `dose`, we will study the impact of these two variables on tooth growth and present our conclusions, including the assumptions made.

## Exploring the dataset

In this section, we will load the ToothGrowth dataset and perform some exploratory data analysis, before performing our hypothesis testing in the next section.

```{r init}
# Libraries
library(datasets)
library(ggplot2)
library(grid)
library(gridExtra)

# Load data & basic data info
data(ToothGrowth)
ToothGrowth$dose <- as.factor(ToothGrowth$dose)
summary(ToothGrowth)
```

The data represents 60 observations, with the length of teeth in each of 10 guinea pigs after following three dose levels of Vitamin C (0.5, 1 and 2 mg) with each of two delivery methods (orange juice OJ or ascorbic acid AC).

We'll now explore the data using some simple boxplots to get an idea if `supp` and `dose` have an impact on tooth length and in which way.

```{r explo, fig.align='center'}
# Plot length vs dose & supp
g1 <- ggplot(aes(x = dose, y = len), data = ToothGrowth) + geom_boxplot(aes(fill = dose))
g2 <- ggplot(aes(x = supp, y = len), data = ToothGrowth) + geom_boxplot(aes(fill = supp))
grid.arrange(g1, g2, ncol=2)

ggplot(aes(x = supp, y = len), data = ToothGrowth) + 
    geom_boxplot(aes(fill = supp)) + facet_wrap(~ dose)
```

In the graphs above, we can see a clear trend: the larger the dosage, the longer the tooth. However, the effectiveness of delivery method is not clear, both OJ and VC have roughly the same performance (with OJ having a slightly higher mean).

Looking at both variables together gives an interesting insight: it seems that at lower doses OJ is more effective than VC in terms of tooth length, but at high dosage (2mg), the performance is the same.

## Confidence Intervals and Hypothesis Testing

The objective of this section is to use

### 3.1 Dosage as a Factor

````{r echo=TRUE, message=F, warning=F}
    dose1 <- subset(ToothGrowth, dose %in% c(0.5, 1.0))
    dose2 <- subset(ToothGrowth, dose %in% c(0.5, 2.0))
    dose3 <- subset(ToothGrowth, dose %in% c(1.0, 2.0))
    t.test(len ~ dose, paired = F, var.equal = F, data = dose1)
````

````{r echo=TRUE, message=F, warning=F}
    t.test(len ~ dose, paired = F, var.equal = F, data = dose2)
````

````{r echo=TRUE, message=F, warning=F}
    t.test(len ~ dose, paired = F, var.equal = F, data = dose3)
````

The confidence intervals ([-11.98, -6.276] for doses 0.5 and 1.0, [-18.16, -12.83] for doses 0.5 and 2.0, and [-8.996, -3.734] for doses 1.0 and 2.0) allow for the rejection of the null hypothesis and a confirmation that there is a significant correlation between tooth length and dose levels.

### 3.2 Supplement as a Factor

Analyzing the data for correlation between the delivery method and change in tooth growth:

````{r echo=TRUE, message=F, warning=F}
    t.test(len ~ supp, paired = F, var.equal = F, data = ToothGrowth)
````

A confidence interval of [-0.171, 7.571] does not allow us to reject the null hypothesis (that there is no correlation between delivery method and tooth length).

## 4. Conclusions and Assumptions

### 4.1 Assumptions

In order to make conclusions with the data in this dataset, we must assume the following:

1. The poplulations are independent, the variances between populations are different and a random population was used
2. The population was comprised of similar guinea pigs, measurement error was accounted for with significant digits, and double blind research methods were used. 
3. For the populations to be independent, 60 guinea pigs would have to be used so each combination of dose level and delivery method were not affected by the other methods. 
4. To ensure double blind research methods are followed, the researchers taking the measurements must have been unaware of which guinea pigs were given which dose level or delivery method. 
5. The guinea pigs must also be unaware that they are being given a specific treatment.

## Conclusions

1. Supplement type has no effect on tooth growth.
2. Increasing the dose level leads to increased tooth growth.

## Appendix

This analysis was completed with the below system:

```{r session}
sessionInfo()
```
